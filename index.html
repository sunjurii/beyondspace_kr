<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>공유오피스 자리맵</title>
  <style>
    body {
    font-family: Arial, sans-serif;
    background-color: #efd03a;
    margin: 0;
    padding: 20px;
    text-align: center;
    }
    #container {
      position: relative;
      width: 585px;
      height: 445px;
      background-color: #efd03a;
      margin: 20px auto;
      border-radius: 10px;
    }
    .seat {
      position: absolute;
      width: 40px;
      height: 40px;
      background-color: #ffffff; /* 기본 하얀색 (빈 자리) */
      border: 1px solid #aaa;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #fff;
      cursor: default;
    }
    .seat.occupied {
      background-color: #ff4d4d; /* 자리 있음 빨간색 */
    }
    .status-guide {
      margin: 20px auto;
      font-size: 16px;
    }
    .status-guide span {
      margin: 0 10px;
    }
  </style>
</head>
<body>

<!-- 로고 이미지 -->
<div style="margin-bottom: 10px;">
  <img src="logo.png" alt="공유 오피스 로고" style="height:80px;">
</div>

<!-- 자리 설명 -->
<div class="status-guide">
  <span>🔴 자리있음</span> 
  <span>⚪️ 빈자리</span>
</div>

<!-- 자리 맵 -->
<div id="container"></div>

<script>
const container = document.getElementById('container');

const seats = [
  [1, 30, 30], [2, 30, 100], [3, 30, 170], [4, 30, 240],
  [5, 120, 30], [6, 120, 70], [7, 120, 130], [8, 120, 170], [9, 120, 230], [10, 120, 270],
  [11, 210, 30], [12, 210, 70], [13, 210, 130], [14, 210, 170], [15, 210, 230], [16, 210, 270],
  [17, 300, 30], [18, 300, 70], [19, 300, 130], [20, 300, 170], [21, 300, 230], [22, 300, 270],
  [23, 120, 330], [24, 120, 370], [25, 160, 330], [26, 160, 370],
  [27, 220, 330], [28, 220, 370], [29, 260, 330], [30, 260, 370], [31, 300, 330], [32, 300, 370],
  [33, 400, 30], [34, 400, 70], [35, 400, 110], [36, 400, 150], [37, 400, 190], [38, 400, 230], [39, 400, 270], [40, 400, 310],
  [41, 440, 30], [42, 440, 70], [43, 440, 110], [44, 440, 150], [45, 440, 190], [46, 440, 230], [47, 440, 270], [48, 440, 310],
  [49, 510, 30], [50, 510, 100], [51, 510, 170], [52, 510, 240], [53, 510, 310]
];

const sheetId = "1cKx6lngayU_DIGUBg_403uC2phn0ZXGYyJK4037IYfs"; // 네 구글시트 ID
const apiKey = "AIzaSyDER31yuEa0w-7ALKHLYoF-pZVpWXhe5tY"; // 구글 API 키를 넣어야 함

async function fetchOccupiedSeats() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Sheet1?key=${apiKey}`;
  const response = await fetch(url);
  const data = await response.json();
  const values = data.values || [];
  const occupiedSeats = values.flat().map(Number);
  return new Set(occupiedSeats);
}

function renderSeats(occupiedSet) {
  seats.forEach(([num, left, top]) => {
    const seat = document.createElement('div');
    seat.className = 'seat';
    seat.innerText = num;
    seat.style.left = left + 'px';
    seat.style.top = top + 'px';
    if (occupiedSet.has(num)) {
      seat.classList.add('occupied');
    }
    container.appendChild(seat);
  });
}

fetchOccupiedSeats().then(renderSeats);

   // 5분(300초)마다 자동 새로고침
  setInterval(() => {
    location.reload();
  }, 300000); // 300,000ms = 5분
</script>

</body>
</html>
